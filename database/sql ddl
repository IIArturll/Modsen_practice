create schema if not exists modsen;

create table if not exists modsen.role (
    id int primary key generated by default as identity,
    role varchar(50) not null
);

create table if not exists modsen.user (
    id int primary key generated by default as identity,
    name varchar(255) not null,
    surname varchar(255) not null,
    email varchar(255) unique not null,
    login varchar(255) unique not null,
    password varchar(255) not null,
    role_id int references modsen.role(id),
    sex int not null,
    birthday date not null
);

create table if not exists modsen.category (
    id int primary key generated by default as identity,
    name varchar(255) not null,
    description varchar(255) not null
);

create table if not exists modsen.orders(
    id int primary key generated by default as identity,
    user_id int references modsen.user(id),
    price decimal(10, 2) not null,
    cooking_time int not null,
    order_time timestamp
);

create table if not exists modsen.product(
    id int primary key generated by default as identity,
    name varchar(255) not null,
    weight int not null,
    calories int not null,
    protein int not null,
    fats int not null,
    carbs int not null,
    price decimal(10, 2) not null,
    categories_id int references modsen.category(id)
);

create table if not exists modsen.order_product(
    id int primary key generated by default as identity,
    order_id int references modsen.orders(id),
    product_id int references modsen.product(id)
);

create table if not exists modsen.ingredient(
    id int primary key generated by default as identity,
    name varchar(255) not null,
    calories int not null,
    protein int not null,
    fats int not null,
    carbs int not null
);

create table if not exists modsen.product_ingredient(
    id int primary key generated by default as identity,
    ingredient_id int references modsen.ingredient(id),
    product_id int references modsen.product(id),
    weight decimal(10, 2)
);

create table if not exists modsen.ingredient_model(
    id int primary key generated by default as identity,
    ingredient_id int references modsen.ingredient(id),
    weight int not null
);